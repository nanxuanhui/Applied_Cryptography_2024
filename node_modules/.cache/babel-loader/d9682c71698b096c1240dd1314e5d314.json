{"remainingRequest":"/Users/nanxuan/Desktop/vue-frontend/node_modules/babel-loader/lib/index.js!/Users/nanxuan/Desktop/vue-frontend/node_modules/eslint-loader/index.js??ref--13-0!/Users/nanxuan/Desktop/vue-frontend/src/assets/encrypt.js","dependencies":[{"path":"/Users/nanxuan/Desktop/vue-frontend/src/assets/encrypt.js","mtime":1710256976000},{"path":"/Users/nanxuan/Desktop/vue-frontend/node_modules/cache-loader/dist/cjs.js","mtime":1712020702053},{"path":"/Users/nanxuan/Desktop/vue-frontend/node_modules/babel-loader/lib/index.js","mtime":1712020702448},{"path":"/Users/nanxuan/Desktop/vue-frontend/node_modules/eslint-loader/index.js","mtime":1712020702117}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvVXNlcnMvbmFueHVhbi9EZXNrdG9wL3Z1ZS1mcm9udGVuZC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIi9Vc2Vycy9uYW54dWFuL0Rlc2t0b3AvdnVlLWZyb250ZW5kL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSAiL1VzZXJzL25hbnh1YW4vRGVza3RvcC92dWUtZnJvbnRlbmQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2RlZmluZVByb3BlcnR5IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmcuanMiOwppbXBvcnQgQUVTIGZyb20gJy4vQUVTLmpzJzsKaW1wb3J0IFJTQSBmcm9tICcuL1JTQS5qcyc7CmltcG9ydCBNRDUgZnJvbSAnY3J5cHRvLWpzL21kNSc7CmltcG9ydCB7IEJhc2U2NCB9IGZyb20gJ2pzLWJhc2U2NCc7Cgp2YXIgRW5jcnlwdCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gRW5jcnlwdChwYXJhbXMsIGRldmljZUluZm8pIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBFbmNyeXB0KTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgIm9wdGlvbnMiLCB7CiAgICAgIHNlcXVlbmNlTm86IHRoaXMuZ2V0R3VpZCgpLAogICAgICAvLyDpobnnm67niYjmnKzlj7cKICAgICAgdmVyc2lvbjogJzEuMScsCiAgICAgIC8vIOaXtumXtOaIswogICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkuZ2V0VGltZSgpLAogICAgICAvLyDnrb7lkI0KICAgICAgc2lnbmF0dXJlOiAnJywKICAgICAgLy8gQUVT6ZqP5py6a2V55Y+KaXbnu4TmiJDnmoRqc29u5a2X56ym5LiyIOS9v+eUqCBSU0Eg5Yqg5a+G5ZCO55qE5a+G5paHCiAgICAgIGVuY3J5cHRlZEtleTogJycsCiAgICAgIC8vIGVuY3J5cHRlZERhdGEg5Li65Lul5LiLSlNPTuagvOW8j+eahOWKoOWvhuaVsOaNrgogICAgICBlbmNyeXB0ZWREYXRhOiB7CiAgICAgICAgaGVhZDogewogICAgICAgICAgZGV2aWNlSUQ6ICcnLAogICAgICAgICAgZGV2aWNlTmFtZTogJycsCiAgICAgICAgICBvc1R5cGU6ICcnLAogICAgICAgICAgb3NWZXJzaW9uOiAnJywKICAgICAgICAgIHBob25lVHlwZTogJycsCiAgICAgICAgICBjbGllbnRTZWNyZXQ6ICcnLAogICAgICAgICAgc3Vic2NyaXB0aW9uSUQ6ICcnCiAgICAgICAgfSwKICAgICAgICAvLyDkuJrliqHor7fmsYLlj4LmlbAKICAgICAgICBib2R5OiAnJwogICAgICB9CiAgICB9KTsKCiAgICB0aGlzLm9wdGlvbnMuZW5jcnlwdGVkRGF0YS5ib2R5ID0gcGFyYW1zOwogICAgdGhpcy5zZXRTeXN0ZW1JbmZvKGRldmljZUluZm8pOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEVuY3J5cHQsIFt7CiAgICBrZXk6ICJzaWduIiwKICAgIHZhbHVlOgogICAgLyoqDQogICAgICog562+5ZCNDQogICAgICogQHJldHVybiB7U3RyaW5nfSDnrb7lkI3lrZfnrKbkuLINCiAgICAgKiAqKi8KICAgIGZ1bmN0aW9uIHNpZ24oanNvblN0cikgewogICAgICAvLyAxLuWwhuWKoOWvhuWJjeeahGVuY3J5cHRlZERhdGHnmoRqc29u5a2X56ym5Liy6L+b6KGMbWQ15pON5L2c77yMCiAgICAgIC8vIDIu5YaN5bCG5oql5paH5LitdGltZXN0YW1w562J5a2X5q615Lula2V5PXZhbHVl55qE5b2i5byP5oyJ54Wna2V55ZCN56ew6L+b6KGM5Y2H5bqP5o6S5bqP77yM5bm25LulJuaLvOaOpeWtl+espuS4sgogICAgICAvLyAzLuWwhuaLvOaOpeWQjueahOWtl+espuS4sui/m+ihjFJTQeengemSpeWKoOWvhuWQjuW+l+WIsHNpZ25hdHVyZeetvuWQjeWtl+autQogICAgICAvLyDms6jmhI/liY3lkI7nq6/liqDnrb7pqoznrb7nmoTlrZfmrrXmmK/lkKbkuIDoh7TnmoQKICAgICAgdmFyIHNpZ25EYXRhID0gewogICAgICAgIGNsaWVudElEOiAnJywKICAgICAgICBlbmNyeXB0ZWREYXRhOiBNRDUoanNvblN0ciksCiAgICAgICAgc2VxdWVuY2VObzogdGhpcy5vcHRpb25zLnNlcXVlbmNlTm8sCiAgICAgICAgdGltZXN0YW1wOiB0aGlzLm9wdGlvbnMudGltZXN0YW1wLAogICAgICAgIHZlcnNpb246IHRoaXMub3B0aW9ucy52ZXJzaW9uCiAgICAgIH07CiAgICAgIHZhciBzdHIgPSBSU0EuZ2V0S2V5VmFsKHNpZ25EYXRhKTsKICAgICAgcmV0dXJuIFJTQS5zaWduU0hBMjU2KHN0cik7CiAgICB9IC8vIOiOt+WPlmVuY3J5cHRlZERhdGEg5ZKMIGVuY3J5cHRlZEtleQoKICB9LCB7CiAgICBrZXk6ICJnZXRFbmNyeXB0ZWREYXRhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRFbmNyeXB0ZWREYXRhKGpzb25TdHIpIHsKICAgICAgLy8gMS4g6ZqP5py655Sf5oiQQUVT5a+G6ZKla2V5KGJhc2U2NOe8lueggSnvvIzlkJHph49pdigxNuS9jSkKICAgICAgdmFyIGtleSA9IEFFUy5jcmVhdGVBZXNLZXkoKTsKICAgICAgdmFyIGFlc0tleSA9IEJhc2U2NC5lbmNvZGUoa2V5KTsKICAgICAgdmFyIGl2ID0gQUVTLmNyZWF0ZUFlc0l2KCk7IC8vIDIuIOS9v+eUqGtleeWSjGl25a+55pyq5Yqg5a+G55qEZW5jcnlwdGVkRGF0YeeahGpzb27lrZfnrKbkuLLov5vooYxBRVPliqDlr4bvvIzlvpfliLBlbmNyeXB0ZWREYXRhCiAgICAgIC8vIGVuY3J5cHRlZERhdGHvvJoKCiAgICAgIHZhciBlbmNyeXB0ZWREYXRhID0gQUVTLmVuY3J5cHRBRVMoanNvblN0ciwgYWVzS2V5LCBpdik7IC8vIDMu5bCGa2V55ZKMaXbnu4TmiJDnmoRqc29u5a2X56ym5Liy6L+b6KGMUlNB5YWs6ZKl5Yqg5a+GCiAgICAgIC8vIGVuY3J5cHRlZEtlee+8mgoKICAgICAgdmFyIG9iak1hcCA9IHsKICAgICAgICBrZXk6IGFlc0tleSwKICAgICAgICBpdjogaXYKICAgICAgfTsgLy8gQGJ1ZyBSU0EucHVibGljRW5jcnlwdOaPkOekum1lc3NhZ2UgdG9vIGxvbmcuLi4KICAgICAgLy8gQHJlc29sdmU6IGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzE1MjA2NTk0L3JzYS1tZXNzYWdlLXRvby1sb25nLWphdmFzY3JpcHQtanNibgogICAgICAvLyDmj5DnpLptZXNzYWdl6L+H6ZW/6Lef55Sf5oiQ5a+G6ZKl5L2N5pWw5pyJ5YWz77yMMTAyNOS9jeWvhumSpeWcqOayoeacieWhq+WFheeahOaDheWGteS4i+WPquiDveWKoOWvhjExN+S4quWtl+iKgu+8jDIwNDjkvY3lj6/ku6XliqDlr4YyNDXvvIw0MDk25L2N5Y+v5Lul5Yqg5a+GNTAx5Liq5a2X6IqCCgogICAgICB2YXIgZW5jcnlwdGVkS2V5ID0gUlNBLnB1YmxpY0VuY3J5cHQoSlNPTi5zdHJpbmdpZnkob2JqTWFwKSk7CiAgICAgIHJldHVybiB7CiAgICAgICAgZW5jcnlwdGVkS2V5OiBlbmNyeXB0ZWRLZXksCiAgICAgICAgZW5jcnlwdGVkRGF0YTogZW5jcnlwdGVkRGF0YQogICAgICB9OwogICAgfQogICAgLyoqDQogICAgICog55Sf5oiQ5Yqg5a+G5ZCO55qE5pWw5o2uDQogICAgICogKiovCgogIH0sIHsKICAgIGtleTogImdlbmVyYXRlRGF0YSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2VuZXJhdGVEYXRhKCkgewogICAgICB2YXIganNvblN0ciA9IEpTT04uc3RyaW5naWZ5KHRoaXMub3B0aW9ucy5lbmNyeXB0ZWREYXRhKTsKICAgICAgdmFyIGVuY3J5cHRlZCA9IHRoaXMuZ2V0RW5jcnlwdGVkRGF0YShqc29uU3RyKTsKICAgICAgcmV0dXJuIHsKICAgICAgICBzZXF1ZW5jZU5vOiB0aGlzLm9wdGlvbnMuc2VxdWVuY2VObywKICAgICAgICB0aW1lc3RhbXA6IHRoaXMub3B0aW9ucy50aW1lc3RhbXAsCiAgICAgICAgdmVyc2lvbjogdGhpcy5vcHRpb25zLnZlcnNpb24sCiAgICAgICAgc2lnbmF0dXJlOiB0aGlzLnNpZ24oanNvblN0ciksCiAgICAgICAgZW5jcnlwdGVkS2V5OiBlbmNyeXB0ZWQuZW5jcnlwdGVkS2V5LAogICAgICAgIGVuY3J5cHRlZERhdGE6IGVuY3J5cHRlZC5lbmNyeXB0ZWREYXRhCiAgICAgIH07CiAgICB9CiAgICAvKioNCiAgICAgKiDorr7nva7ns7vnu5/kv6Hmga8NCiAgICAgKiAqKi8KCiAgfSwgewogICAga2V5OiAic2V0U3lzdGVtSW5mbyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0U3lzdGVtSW5mbyhpbmZvKSB7CiAgICAgIHZhciBoZWFkID0gdGhpcy5vcHRpb25zLmVuY3J5cHRlZERhdGEuaGVhZDsKICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oaGVhZCwgaW5mbyk7CiAgICB9CiAgICAvKioNCiAgICAgKiDnlJ/miJDmtYHmsLTlj7cNCiAgICAgKiAqKi8KCiAgfSwgewogICAga2V5OiAiZ2V0R3VpZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0R3VpZCgpIHsKICAgICAgZnVuY3Rpb24gUzQoKSB7CiAgICAgICAgcmV0dXJuICgoMSArIE1hdGgucmFuZG9tKCkpICogMHgxMDAwMCB8IDApLnRvU3RyaW5nKDE2KS5zdWJzdHJpbmcoMSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBTNCgpICsgUzQoKSArICItIiArIFM0KCkgKyAiLSIgKyBTNCgpICsgIi0iICsgUzQoKSArICItIiArIFM0KCkgKyBTNCgpICsgUzQoKTsKICAgIH0KICB9XSk7CgogIHJldHVybiBFbmNyeXB0Owp9KCk7CgpleHBvcnQgeyBFbmNyeXB0IGFzIGRlZmF1bHQgfTs="},{"version":3,"sources":["/Users/nanxuan/Desktop/vue-frontend/src/assets/encrypt.js"],"names":["AES","RSA","MD5","Base64","Encrypt","params","deviceInfo","sequenceNo","getGuid","version","timestamp","Date","getTime","signature","encryptedKey","encryptedData","head","deviceID","deviceName","osType","osVersion","phoneType","clientSecret","subscriptionID","body","options","setSystemInfo","jsonStr","signData","clientID","str","getKeyVal","signSHA256","key","createAesKey","aesKey","encode","iv","createAesIv","encryptAES","objMap","publicEncrypt","JSON","stringify","encrypted","getEncryptedData","sign","info","Object","assign","S4","Math","random","toString","substring"],"mappings":"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","sourcesContent":["import AES from './AES.js'\r\nimport RSA from './RSA.js'\r\nimport MD5 from 'crypto-js/md5';\r\nimport {Base64} from 'js-base64'\r\n\r\nexport default class Encrypt {\r\n\tconstructor(params, deviceInfo) {\r\n\t\tthis.options.encryptedData.body = params;\r\n\t\tthis.setSystemInfo(deviceInfo);\r\n\t}\r\n\toptions = {\r\n\t\t\r\n\t\tsequenceNo: this.getGuid(),\r\n\t\t// 项目版本号\r\n\t\tversion: '1.1',\r\n\t\t// 时间戳\r\n\t\ttimestamp: new Date().getTime(),\r\n\t\t// 签名\r\n\t\tsignature: '',\r\n\t\t// AES随机key及iv组成的json字符串 使用 RSA 加密后的密文\r\n\t\tencryptedKey: '',\r\n\t\t// encryptedData 为以下JSON格式的加密数据\r\n\t\tencryptedData: {\r\n\t\t\thead: {\r\n\t\t\t\tdeviceID: '',\r\n\t\t\t\tdeviceName: '',\r\n\t\t\t\tosType: '',\r\n\t\t\t\tosVersion: '',\r\n\t\t\t\tphoneType: '',\r\n\t\t\t\tclientSecret: '',\r\n\t\t\t\tsubscriptionID: ''\r\n\t\t\t},\r\n\t\t\t// 业务请求参数\r\n\t\t\tbody: ''\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t * 签名\r\n\t * @return {String} 签名字符串\r\n\t * **/\r\n\tsign(jsonStr) {\r\n\t\t// 1.将加密前的encryptedData的json字符串进行md5操作，\r\n\t\t// 2.再将报文中timestamp等字段以key=value的形式按照key名称进行升序排序，并以&拼接字符串\r\n\t\t// 3.将拼接后的字符串进行RSA私钥加密后得到signature签名字段\r\n\t\t// 注意前后端加签验签的字段是否一致的\r\n\t\tconst signData = {\r\n\t\t\tclientID: '',\r\n\t\t\tencryptedData: MD5(jsonStr),\r\n\t\t\tsequenceNo: this.options.sequenceNo,\r\n\t\t\ttimestamp: this.options.timestamp,\r\n\t\t\tversion: this.options.version\r\n\t\t}\r\n\t\tconst str = RSA.getKeyVal(signData);\r\n\t\treturn RSA.signSHA256(str)\r\n\t}\r\n\r\n\t// 获取encryptedData 和 encryptedKey\r\n\tgetEncryptedData(jsonStr) {\r\n\t\t// 1. 随机生成AES密钥key(base64编码)，向量iv(16位)\r\n\t\tconst key = AES.createAesKey()\r\n\t\tconst aesKey = Base64.encode(key)\r\n\t\tconst iv = AES.createAesIv();\r\n\t\t// 2. 使用key和iv对未加密的encryptedData的json字符串进行AES加密，得到encryptedData\r\n\t\t// encryptedData：\r\n\t\tconst encryptedData = AES.encryptAES(jsonStr, aesKey, iv)\r\n\t\t// 3.将key和iv组成的json字符串进行RSA公钥加密\r\n\t\t// encryptedKey：\r\n\t\tconst objMap = {\r\n\t\t\tkey: aesKey,\r\n\t\t\tiv: iv\r\n\t\t}\r\n\t\t// @bug RSA.publicEncrypt提示message too long...\r\n\t\t// @resolve: https://stackoverflow.com/questions/15206594/rsa-message-too-long-javascript-jsbn\r\n\t\t// 提示message过长跟生成密钥位数有关，1024位密钥在没有填充的情况下只能加密117个字节，2048位可以加密245，4096位可以加密501个字节\r\n\t\tconst encryptedKey = RSA.publicEncrypt(JSON.stringify(objMap))\r\n\t\treturn {\r\n\t\t\tencryptedKey,\r\n\t\t\tencryptedData\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t * 生成加密后的数据\r\n\t * **/\r\n\tgenerateData() {\r\n\t\tconst jsonStr = JSON.stringify(this.options.encryptedData)\r\n\t\tconst encrypted = this.getEncryptedData(jsonStr)\r\n\t\treturn {\r\n\t\t\tsequenceNo: this.options.sequenceNo,\r\n\t\t\ttimestamp: this.options.timestamp,\r\n\t\t\tversion: this.options.version,\r\n\t\t\tsignature: this.sign(jsonStr),\r\n\t\t\tencryptedKey: encrypted.encryptedKey,\r\n\t\t\tencryptedData: encrypted.encryptedData\r\n\t\t}\r\n\r\n\t}\r\n\t/**\r\n\t * 设置系统信息\r\n\t * **/\r\n\tsetSystemInfo(info) {\r\n\t\tlet head = this.options.encryptedData.head;\r\n\t\treturn Object.assign(head, info)\r\n\t}\r\n\t/**\r\n\t * 生成流水号\r\n\t * **/\r\n\tgetGuid() {\r\n\t\tfunction S4() {\r\n\t\t\treturn (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\r\n\t\t}\r\n\t\treturn (S4() + S4() + \"-\" + S4() + \"-\" + S4() + \"-\" + S4() + \"-\" + S4() + S4() + S4());\r\n\t}\r\n}\r\n"]}]}